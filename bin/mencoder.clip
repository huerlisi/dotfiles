#!/bin/bash
[ "$2" ] || exec echo "Usage: mencoder.clip FILE START +[LENGTH] [MENCODER-OPTIONS]"

if [ -f "$1" ]; then
  file="$1"
  ext=${file##*.}
  ext=${ext%%/*}
  name=`basename "$file" ".$ext"`
  shift
else
  exec echo "File not found: $1"
fi

if echo "$1" | egrep -q "^[0-9:]+$"; then
  start="$1"
  shift
fi

if [ "${1:0:1}" = "+" ]; then
  endpos="-endpos $1"
  shift
fi

mencoder -ovc copy -oac copy -ss "$start" $endpos -o "$name.clip.$ext" $* "$file"
