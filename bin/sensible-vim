#!/bin/sh

# Detect binary filetypes
if [ $# -gt 0 ]; then
  mimetypes=`file -L --brief --mime-type "$@" | grep -vx 'inode/directory' | grep -P '^((?!text/).+|text/rtf)$'`
  if [ -n "$mimetypes" ]; then
    echo -e "Using \e[1;37mxdg-open\e[0m for \e[1;33m$mimetypes\e[0m"
    for file in "$@"; do
      exec xdg-open "$file"
    done
    exit
  fi
fi

if [ -n "$DISPLAY" -a -z "$SSH_CONNECTION" ] && which gvim &>/dev/null; then
  if [ -t 0 ]; then
    unset options
  else
    options="-f"
  fi
  exec gvim $options "$@"
else
  exec vim "$@"
fi
