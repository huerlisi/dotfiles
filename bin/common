#!/bin/bash

unset current last common pos

if [ -n "$1" ]; then
  arguments="$@"
elif [ ! -t 0 ]; then
  arguments=`cat`
else
  exit
fi

for current in $arguments; do
  if [ -v last ]; then
    for (( pos=0; ; ++pos )); do
      a=${last:$pos:1}
      b=${current:$pos:1}

      if [ -z "$a" -o -z "$b" -o "$a" != "$b" ]; then
        break
      fi
    done

    if [ ! -v common -o $pos -lt ${#common} ]; then
      common=${current:0:$pos}
    fi
  else
    common="$current"
  fi

  last="$current"
done

if [ -n "$common" ]; then
  echo "$common"
fi
