#!/usr/bin/ruby

$WIDTH = 1850
$HEIGHT = 1065
$X = 40
$Y = 40

$MODE = (ARGV[0] || 'maximize').to_sym

$ID = `xprop -root _NET_ACTIVE_WINDOW`.strip.sub(/.*(0x\w+),.*/, '\1')
exit if $ID.empty?

width, height = `xwininfo -id #{$ID} | awk '/Width:|Height:/ { print $2 }'`.split("\n").map(&:to_i)

case $MODE
when :maximize
  if width >= $WIDTH - 100 and height >= $HEIGHT - 100
    $WIDTH *= 0.7
    $HEIGHT *= 0.95
    $X += 40
    $Y += 20
  end
when :left
  $WIDTH /= 2
  $WIDTH -= 8
when :right
  $X += $WIDTH / 2
  $WIDTH /= 2
when :top
  $X += $WIDTH / 2
  $WIDTH /= 2
  $HEIGHT /= 2
  $HEIGHT -= 14
when :bottom
  $X += $WIDTH / 2
  $Y += $HEIGHT / 2
  $Y += 14
  $WIDTH /= 2
  $HEIGHT /= 2
  $HEIGHT -= 14
end

system("xwit -id #$ID -move #$X #$Y -resize #$WIDTH #$HEIGHT -sync -focus -warp #{width / 2} #{height / 2}")
width, height = `xwininfo -id #{$ID} | awk '/Width:|Height:/ { print $2 }'`.split("\n").map(&:to_i)
system("xwit -id #$ID -focus -warp #{width / 2} #{height / 2}")
